<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Google Photos Slideshow</title>

        <meta name="description" content="A slideshow application for google photos albums.">
        <meta name="author" content="HoleInOneStudios">
        <meta name="keywords" content="Google Photos Slideshow, Google Photos, Slideshow">
        <link rel="manifest" href="./manifest.json">
        <link rel="shortcut icon" href="Google_Photos_icon_(2020).png" type="image/x-icon">

        <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>
        <script src="https://accounts.google.com/gsi/client" async defer></script>

        <link rel="stylesheet" href="style.css">

        <script>
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js');
            }

            document.querySelector('#show').addEventListener('click', () => {
                const iconUrl = document.querySelector('select').selectedOptions[0].value;
            
                // Function to encode HTML entities
                function encodeForHTML(str) {
                    return str.replace(/&/g, '&amp;')
                              .replace(/</g, '&lt;')
                              .replace(/>/g, '&gt;')
                              .replace(/"/g, '&quot;')
                              .replace(/'/g, '&#39;');
                }
            
                // Encode the URL before using it
                const safeIconUrl = encodeForHTML(iconUrl);
            
                // Simple URL validation (optional but recommended)
                const isValidUrl = /^https?:\/\/[a-zA-Z0-9-_.]+/.test(safeIconUrl);
            
                if (!isValidUrl) {
                    alert('Invalid URL');
                    return;
                }
            
                let imgElement = document.createElement('img');
                imgElement.src = safeIconUrl;
                document.querySelector('#container').appendChild(imgElement);
            });
        </script>
    </head>

    <body>
        <main>
            <img id="image" src="" alt="">
        </main>
        <div>
            <a href="https://github.com/HoleInOneStudios/Google-Photos-Slideshow">Github</a>
            <a href="https://holeinonestudios.org">HoleInOneStudios</a>

            <br>

            <button onclick="getToken();">Login and Authenticate</button>

            <br>

            <label for="album_select">Select an album:</label>
            <select id="album_select" value=""></select>
            <button onclick="getAlbumPhotos();">Get Photos</button>

            <br>

            <label for="slideshow_speed">Select Slideshow Speed:</label>
            <input type="number" id="slideshow_speed" min="1" value="3">
            <button onclick="setSpeed()">Set Speed</button>

            <br>

            <label for="slideshow_mode">Select Slideshow Mode:</label>
            <select id="slideshow_mode" value="random" oninput="setMode()">
                <option value="random" selected>Random</option>
                <option value="sequential">Sequential</option>
            </select>
        </div>
    </body>

    <script src="script.js"></script>

</html>
